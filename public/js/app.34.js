webpackJsonp([34,85],{"6GxI":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.incident?n("div",[n("header",{staticClass:"content-header"},[n("div",{staticClass:"header-actions pull-right hidden-sm hidden-xs desktop"},[n("div",{staticClass:"btn-group pull-right"},[t._m(0),t._v(" "),n("ul",{staticClass:"dropdown-menu"},[n("li",{attrs:{role:"presentation"}},[n("router-link",{attrs:{to:"/incidents/"+t.incident.id+"/edit"}},[n("i",{staticClass:"fas fa-edit fa-fw"}),t._v(" Edit")])],1),t._v(" "),t.authUser.is_admin?n("li",{attrs:{role:"presentation"}},[n("a",{attrs:{href:"#delete"},on:{click:function(e){t.confirmDelete(t.incident.id)}}},[n("i",{staticClass:"fas fa-trash-alt fa-fw"}),t._v(" Delete")])]):t._e()])])]),t._v(" "),n("h1",[t.incident.type?n("span",[t._v(t._s(t.incident.type.name))]):t._e(),t._v(" on "+t._s(t._f("prettyDate")(t.incident.date)))]),t._v(" "),n("div",{staticClass:"header-actions hidden-md hidden-lg mobile"},[n("div",{staticClass:"btn-group"},[t._m(1),t._v(" "),n("ul",{staticClass:"dropdown-menu"},[n("li",{attrs:{role:"presentation"}},[n("router-link",{attrs:{to:"/incidents/"+t.incident.id+"/edit"}},[n("i",{staticClass:"fas fa-edit fa-fw"}),t._v(" Edit")])],1),t._v(" "),t.authUser.is_admin?n("li",{attrs:{role:"presentation"}},[n("a",{attrs:{href:"#delete"},on:{click:function(e){t.confirmDelete(t.incident.id)}}},[n("i",{staticClass:"fas fa-trash-alt fa-fw"}),t._v(" Delete")])]):t._e()])])])]),t._v(" "),n("div",{staticClass:"section"},[t.incident.advocate?n("p",[t._v("\n                Advocate: "),n("b",[t._v(t._s(t.incident.advocate.first_name)+" "+t._s(t.incident.advocate.last_name))])]):t._e(),t._v(" "),n("div",{staticClass:"lead"},[n("p",[t._v("\n                    Client: "),t.incidentClient?n("span",[n("router-link",{attrs:{to:"/clients/"+t.incidentClient.id}},[t._v(t._s(t.incidentClient.full_name))]),t.incident.client_age?[t._v(" ("+t._s(t.incident.client_age)+" at the time)")]:t._e()],2):t._e()]),t._v(" "),n("p",[t._v("\n                    Occurred: "),n("b",[t._v(t._s(t._f("prettyDate")(t.incident.date)))]),t._v("\n                    in "),n("b",[t._v(t._s(t.incident.city)+", "+t._s(t.incident.state))]),t._v(".\n                ")])]),t._v(" "),n("notes",{attrs:{params:t.noteParams,client_id:t.incident.client_id,noteable_id:t.incident.id,noteable_type:t.incident.noteable_type}})],1)]):n("div",{staticClass:"lead section"},[n("i",{staticClass:"fa fa-refresh fa-spin"}),t._v(" Loading data\n    ")])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-primary dropdown-toggle",attrs:{type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[e("i",{staticClass:"fa fa-ellipsis-h"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-primary dropdown-toggle",attrs:{type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[e("i",{staticClass:"fa fa-ellipsis-h"})])}]}},"9OIq":function(t,e,n){"use strict";var i=n("Dd8w"),a=n.n(i),s=n("jtR9"),r=n("UmUL");e.a=a()({},new r.a({name:"incident",storeName:"incidents",model:s.a}))},BGpC:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Dd8w"),a=n.n(i),s=n("bOdI"),r=n.n(s),o=n("NYxO"),c=(n("OQde"),n("fQ0y")),d=n("9OIq"),l=n("IM3Y"),u=n.n(l);e.default={name:"incident-show",mixins:[c.a,d.a],components:{Notes:u.a},computed:{noteParams:function(){return!(!this.$route.params.incident_id||!this.incident.noteable_type)&&{params:{noteable_id:this.$route.params.incident_id,noteable_type:this.incident.noteable_type}}},incidentClient:function(){return this.incident&&this.incident.client_id?this.clientById(this.incident.client_id):null}},created:function(){this.init()},beforeRouteLeave:function(t,e,n){this.reset(),n()},watch:r()({},"params.client_id",function(){isNaN(this.params.client_id)}),methods:a()({},Object(o.b)("incidents",["destroy"]),{confirmDelete:function(t){var e=this;if(confirm("Are you sure that you want to delete this incident?")){var n=this.incident.client_id;this.destroy({id:t}).then(function(){e.addMessage("This incident has been deleted."),e.fetchClient({id:n}),e.$router.push("/clients/"+n)})}},currentIncidentFetched:function(){var t=this;this.$nextTick(function(){var e=t.incidentData.client_id;t.$set(t.params,"client_id",e),t.fetchClient({id:e,fetchId:"id:"+e})})},init:function(){this.fetchCurrentIncident()}})}},IM3Y:function(t,e,n){var i=n("VU/8")(n("smZi"),n("vqbb"),!1,null,null,null);t.exports=i.exports},TG2c:function(t,e,n){var i=n("VU/8")(n("BGpC"),n("6GxI"),!1,null,null,null);t.exports=i.exports},UmUL:function(t,e,n){"use strict";var i=n("Dd8w"),a=n.n(i),s=n("bOdI"),r=n.n(s),o=n("Zrlr"),c=n.n(o),d=n("NYxO"),l=n("OQde"),u=function(t){return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},h=n("TFAV");e.a=function t(e){var n,i,s,o,f=e.name,_=e.storeName,p=e.model,m=void 0===p?h.a:p;c()(this,t),this.modelMixinOptions={name:f,storeName:_,model:m};var v=this;this.data=function(){var t;return t={},r()(t,v.modelMixinOptions.name,new v.modelMixinOptions.model),r()(t,"params",r()({},v.modelMixinOptions.name+"_id",null)),t},this.computed=a()({},Object(d.c)(_,(n={},r()(n,f+"ById","byId"),r()(n,"route"+u(f),"byRoute"),r()(n,"fetching"+u(f),"fetching"),n)),(i={},r()(i,"routeHas"+u(f)+"Model",function(){return this.$route.params&&this.$route.params[f+"_id"]||!1}),r()(i,f+"Data",function(){return this["fetching"+u(f)],this["routeHas"+u(f)+"Model"]?this["route"+u(f)]:this[f+"ById"](this.params[f+"_id"])}),i)),this.created=function(){this["set"+u(f)+"Id"]()},this.watch=(s={},r()(s,f+"Data",{deep:!0,handler:function(){this["reset"+v.modelMixinOptions.name](),this[v.modelMixinOptions.name+"Data"]&&this[""+v.modelMixinOptions.name].assign(this[v.modelMixinOptions.name+"Data"])}}),r()(s,"$route.params."+f+"_id",function(){this["set"+u(f)+"Id"]()}),r()(s,"params."+f+"_id",function(t){null!==t&&this["fetchCurrent"+u(f)]()}),s),this.methods=a()({},Object(d.b)(_,r()({},"fetch"+u(f)+"Data","fetch")),(o={},r()(o,"set"+u(f)+"Id",function(t){t=t?Number(t):this.$route.params[f+"_id"]?Number(this.$route.params[f+"_id"]):null,Vue.set(this.params,f+"_id",t)}),r()(o,f+"IdExists",function(){return Object(l.f)(this.params[f+"_id"])&&null!==this.params[f+"_id"]}),r()(o,"fetch"+u(f),function(t){var e=this;this["fetch"+u(f)+"Data"](t).then(function(t){return e[f+"Fetched"](t),t}).catch(function(t){console.error(t)})}),r()(o,"fetchRoute"+u(f),function(){var t=this,e=Number(this.$route.params[f+"_id"]);return!!e&&this["fetch"+u(f)+"Data"]({id:e,fetchId:"id:"+e}).then(function(e){return t["route"+u(f)+"Fetched"](),t["current"+u(f)+"Fetched"](),e}).catch(function(t){console.error(t)})}),r()(o,"fetchCurrent"+u(f),function(){var t=this,e=Number(this.params[f+"_id"]);return!!e&&this["fetch"+u(f)+"Data"]({id:e,fetchId:"id:"+e}).then(function(e){return t["route"+u(f)+"Fetched"](),t["current"+u(f)+"Fetched"](),e}).catch(function(t){console.error(t)})}),r()(o,"current"+u(f)+"Fetched",function(){}),r()(o,"route"+u(f)+"Fetched",function(){}),r()(o,f+"Fetched",function(){}),r()(o,"reset",function(){this.resetData()}),r()(o,"resetData",function(){this["reset"+f](),this.params[f+"_id"]=null}),r()(o,"reset"+f,function(){this[f]=new m}),o))}},fQ0y:function(t,e,n){"use strict";var i=n("Dd8w"),a=n.n(i),s=n("b+22"),r=n("UmUL");e.a=a()({},new r.a({name:"client",storeName:"clients",model:s.a}))},jtR9:function(t,e,n){"use strict";var i=n("Zx67"),a=n.n(i),s=n("Zrlr"),r=n.n(s),o=n("zwoO"),c=n.n(o),d=n("Pf15"),l=n.n(d),u=n("OQde"),h=n("vXSK"),f=n("TFAV"),_=(n("0aVa"),function(){return{date:Object(u.h)(h.a),client_id:null,advocate_id:null,incident_type_id:null,state:"",city:"",note:""}}),p=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r()(this,e),c()(this,(e.__proto__||a()(e)).call(this,_(),t))}return l()(e,t),e}(f.a);e.a=p},smZi:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Dd8w"),a=n.n(i),s=n("NYxO");e.default={name:"note-list",props:["params","client_id","noteable_type","noteable_id"],data:function(){return{note:"",processing:!1}},computed:a()({},Object(s.c)("notes",["paginated","fetching"]),{notes:function(){return this.paginated}}),created:function(){this.params&&this.fetch(this.params)},watch:{params:function(){this.params&&this.fetch(this.params)}},methods:a()({},Object(s.b)("notes",["create","fetch","destroy"]),{addNote:function(){var t=this;this.processing=!0;var e={data:{advocate_id:this.authUser.id,client_id:this.client_id,content:this.note}};this.noteable_id&&this.noteable_type&&(e.data.noteable_type=this.noteable_type,e.data.noteable_id=this.noteable_id),this.create(e).then(function(){t.processing=!1,t.resetData(),t.fetch(t.params)})},confirmDelete:function(t){var e=this;confirm("Are you sure that you want to delete the note?")&&this.destroy({id:t}).then(function(){e.addMessage("Note has been deleted.")})},resetData:function(){this.note=""}})}},vXSK:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s});var i=n("Dd8w"),a=(n.n(i),n("OQde"),"YYYY-MM-DD"),s=function(){return{first_name:"",last_name:"",email:"",password:"",password_confirmation:""}}},vqbb:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"notes box"},[n("div",{staticClass:"box-header"},[t._v("Notes "),t.fetching?n("i",{staticClass:"fas fa-spinner fa-spin"}):t._e()]),t._v(" "),t.fetching?[t._m(0)]:t.notes.length?[n("div",{staticClass:"box-body box-comments"},t._l(t.notes,function(e){return n("div",{staticClass:"box-comment"},[n("span",{staticClass:"username"},[t._v("\n                    "+t._s(e.advocate.first_name)+" "+t._s(e.advocate.last_name)+"\n                    "),n("span",{staticClass:"text-muted"},[t._v("\n                         on "+t._s(t._f("prettyDatetime")(e.created_at))+"\n                    ")])]),t._v(" "),n("div",{staticClass:"pull-right"},[n("router-link",{staticClass:"btn btn-warning btn-xs",attrs:{to:"/clients/"+e.client_id+"/notes/"+e.id+"/edit?from="+t.$route.path}},[n("i",{staticClass:"fas fa-edit fa-fw"}),t._v(" Edit")]),t._v(" "),t.authUser.is_admin?n("button",{staticClass:"btn btn-danger btn-xs",attrs:{href:"#delete"},on:{click:function(n){n.preventDefault(),t.confirmDelete(e.id)}}},[t._v("Delete")]):t._e()],1),t._v(" "),n("div",{domProps:{innerHTML:t._s(t.$options.filters.markdown(e.content))}})])}))]:t._e(),t._v(" "),t.client_id&&t.noteable_type&&t.noteable_id?n("div",{staticClass:"box-footer"},[n("form",{on:{submit:function(e){return e.preventDefault(),t.addNote(e)}}},[n("div",{staticClass:"form-group"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.note,expression:"note"}],staticClass:"form-control input-sm",attrs:{placeholder:"Add a note"},domProps:{value:t.note},on:{input:function(e){e.target.composing||(t.note=e.target.value)}}})]),t._v(" "),n("button",{staticClass:"btn btn-success btn-sm",attrs:{disabled:t.processing}},[t._v("Add note"),t.processing?[n("i",{staticClass:"fa fa-refresh fa-spin"})]:t._e()],2)])]):t._e()],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"box-body"},[e("div",{staticClass:"lead"},[this._v("Loading notes")])])}]}}});