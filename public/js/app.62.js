webpackJsonp([62],{"74Z1":function(t,e,n){var i=n("VU/8")(n("cwHg"),n("Lv6h"),!1,null,null,null);t.exports=i.exports},Lv6h:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.fetching?n("div",{staticClass:"lead"},[n("i",{staticClass:"fa fa-refresh fa-spin"}),t._v(" Loading data\n    ")]):!t.fetching&&t.incidents.length?n("div",[n("grid",{attrs:{fields:t.fields,data:t.incidents,fetching:t.fetching,meta:t.meta},scopedSlots:t._u([{key:"type.name",fn:function(e){return[t.client?n("router-link",{attrs:{to:"/incidents/"+e.item.id}},[t._v(t._s(e.item.type.name))]):t._e()]}},{key:"date",fn:function(e){return[t._v("\n                "+t._s(t._f("prettyDate")(e.item.date))+"\n            ")]}},{key:"actions",fn:function(e){return[n("div",{staticClass:"table-button-container"},[t.client?n("router-link",{staticClass:"btn btn-warning btn-xs",attrs:{to:"/incidents/"+e.item.id+"/edit"}},[n("i",{staticClass:"fa fa-edit"}),t._v(" Edit")]):t._e(),t._v(" "),t.authUser.is_admin?n("button",{staticClass:"btn btn-danger btn-xs",on:{click:function(n){t.confirmDelete(e.item.id)}}},[n("i",{staticClass:"fa fa-remove"}),t._v(" Delete")]):t._e(),t._v("  \n                ")],1)]}}])})],1):t.client?n("div",{staticClass:"lead"},[n("i",{staticClass:"fa fa-info-circle"}),t._v(" An incident is required to start adding activities and outcomes. "),n("router-link",{attrs:{to:"/clients/"+t.client.id+"/incidents/add"}},[n("i",{staticClass:"fas fa-exclamation-triangle"}),t._v(" Add an incident")]),t._v(" to get started.\n    ")],1):t._e()])},staticRenderFns:[]}},UmUL:function(t,e,n){"use strict";var i=n("Dd8w"),a=n.n(i),s=n("bOdI"),r=n.n(s),c=n("Zrlr"),o=n.n(c),d=n("NYxO"),u=n("OQde"),h=function(t){return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},f=n("TFAV");e.a=function t(e){var n,i,s,c,l=e.name,m=e.storeName,p=e.model,_=void 0===p?f.a:p;o()(this,t),this.modelMixinOptions={name:l,storeName:m,model:_};var v=this;this.data=function(){var t;return t={},r()(t,v.modelMixinOptions.name,new v.modelMixinOptions.model),r()(t,"params",r()({},v.modelMixinOptions.name+"_id",null)),t},this.computed=a()({},Object(d.c)(m,(n={},r()(n,l+"ById","byId"),r()(n,"route"+h(l),"byRoute"),r()(n,"fetching"+h(l),"fetching"),n)),(i={},r()(i,"routeHas"+h(l)+"Model",function(){return this.$route.params&&this.$route.params[l+"_id"]||!1}),r()(i,l+"Data",function(){return this["fetching"+h(l)],this["routeHas"+h(l)+"Model"]?this["route"+h(l)]:this[l+"ById"](this.params[l+"_id"])}),i)),this.created=function(){this["set"+h(l)+"Id"]()},this.watch=(s={},r()(s,l+"Data",{deep:!0,handler:function(){this["reset"+v.modelMixinOptions.name](),this[v.modelMixinOptions.name+"Data"]&&this[""+v.modelMixinOptions.name].assign(this[v.modelMixinOptions.name+"Data"])}}),r()(s,"$route.params."+l+"_id",function(){this["set"+h(l)+"Id"]()}),r()(s,"params."+l+"_id",function(t){null!==t&&this["fetchCurrent"+h(l)]()}),s),this.methods=a()({},Object(d.b)(m,r()({},"fetch"+h(l)+"Data","fetch")),(c={},r()(c,"set"+h(l)+"Id",function(t){t=t?Number(t):this.$route.params[l+"_id"]?Number(this.$route.params[l+"_id"]):null,Vue.set(this.params,l+"_id",t)}),r()(c,l+"IdExists",function(){return Object(u.f)(this.params[l+"_id"])&&null!==this.params[l+"_id"]}),r()(c,"fetch"+h(l),function(t){var e=this;this["fetch"+h(l)+"Data"](t).then(function(t){return e[l+"Fetched"](t),t}).catch(function(t){console.error(t)})}),r()(c,"fetchRoute"+h(l),function(){var t=this,e=Number(this.$route.params[l+"_id"]);return!!e&&this["fetch"+h(l)+"Data"]({id:e,fetchId:"id:"+e}).then(function(e){return t["route"+h(l)+"Fetched"](),t["current"+h(l)+"Fetched"](),e}).catch(function(t){console.error(t)})}),r()(c,"fetchCurrent"+h(l),function(){var t=this,e=Number(this.params[l+"_id"]);return!!e&&this["fetch"+h(l)+"Data"]({id:e,fetchId:"id:"+e}).then(function(e){return t["route"+h(l)+"Fetched"](),t["current"+h(l)+"Fetched"](),e}).catch(function(t){console.error(t)})}),r()(c,"current"+h(l)+"Fetched",function(){}),r()(c,"route"+h(l)+"Fetched",function(){}),r()(c,l+"Fetched",function(){}),r()(c,"reset",function(){this.resetData()}),r()(c,"resetData",function(){this["reset"+l](),this.params[l+"_id"]=null}),r()(c,"reset"+l,function(){this[l]=new _}),c))}},cwHg:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("bOdI"),a=n.n(i),s=n("Dd8w"),r=n.n(s),c=n("NYxO"),o=n("fQ0y");e.default={name:"incident-index",mixins:[o.a],data:function(){return{fields:[{name:"type.name",title:"Type"},"date",{name:"client_age",title:"Age"},{name:"advocate.name",title:"Advocate",template:"{{ advocate.first_name }} {{ advocate.last_name }}",sortField:"advocate.last_name"},"state","city",{name:"actions",dataClass:"fit-content",titleClass:"fit-content",sortable:!1}]}},computed:r()({},Object(c.c)("incidents",{byId:"byId",fetching:"fetching",incidents:"paginated",meta:"meta"})),beforeRouteUpdate:function(t,e,n){this.init(t.query),n()},watch:a()({},"params.client_id",function(){this.init(this.$route.query)}),methods:r()({},Object(c.b)("incidents",["destroy","fetch","setQuery"]),{confirmDelete:function(t){var e=this;if(confirm("Are you sure that you want to delete this incident?")){var n=this.byId(t).client_id;this.destroy({id:t}).then(function(){e.addMessage("This incident has been deleted."),e.fetchClient({id:n})})}},init:function(t){var e={params:r()({},this.params,{page:t&&t.page||1})};this.fetch(e)}})}},fQ0y:function(t,e,n){"use strict";var i=n("Dd8w"),a=n.n(i),s=n("b+22"),r=n("UmUL");e.a=a()({},new r.a({name:"client",storeName:"clients",model:s.a}))}});